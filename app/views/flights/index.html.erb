<div class="container">
  <div class="banner_destination_picture">
   <img src="" alt="">
  </div>

  <div class="inline_search_bar">
    <div class="inline_search_form">
      <div class="card-panel blue-text text-darken-2 search_card">
        <!-- définir la route exact et le type de méthode get/post -->
        <%= form_tag(flights_path, method: :get) do %>
        <div class="row">
        <div class="line1 col s12 "></div>
          <div class="input-field col m3 s6">
            <%= number_field(:duration, nil, in: 1..30, step: 1, placeholder: "Durée du séjour en jours", class: "validate") %>
          </div>
          <div class="input-field col m3 s6">
            <%= select_tag(:periode, options_for_select(@periode), multiple: false) %>
          </div>
          <div class="input-field col m3 s6">
            <%= text_field_tag(:departure, nil, placeholder:"Départ", class: "validate") %>
          </div>
          <div class="input-field col m3 s6">
            <%= text_field_tag(:destination, nil, placeholder:"Destination", class: "validate") %>
          </div>
        </div>
        <div class="row">
          <div class="line2 col s12">
            <div class="passagers_selection col s6">
              <div class="input-field passagers_child col s2">
                <p>Enfant(s)</p>
                <%= select_tag(:passagers_child, options_for_select(@passagers_number), class: "browser-default") %>
              </div>
              <div class="input-field passagers_young col s2">
                <p>Jeune(s)</p>
                <%= select_tag(:passagers_young, options_for_select(@passagers_number), class: "browser-default") %>
              </div>
              <div class="input-field passagers_adult col s2">
                <p>Adulte(s)</p>
                <%= select_tag(:passagers_adult, options_for_select(@passagers_number), class: "browser-default") %>
              </div>
            </div>
            <div class="input-field col s4 offset-s1">
              <%= submit_tag("Rechercher", class: "search_button btn waves-effect waves-light") %>
            </div>
          </div>
           <div class="slider_price_duration">Slider</div>
          </div>
        </div>
        <% end %>
      </div>
    </div>

  <div class="results_wrapper">
    <div class="results_lists">
      <% @trips_results.each do |trip|%>
        <div class="box_result">
          <div class="results_card_container">
            <div class="card_result">
              <div class="date_range_graph_field">
                <div class="date_range_graph">
                  <div class="date_representation_sliders" data-departure_date="<%= trip[:depart_flights][0].departure_datetime.to_date.strftime('%e').to_i %>" data-arrival_date="<%= trip[:return_flights][-1].arrival_datetime.to_date.strftime('%e').to_i %>"></div>
                  <p>Mars 2017-- TODO</p>
                </div>
              </div>
              <div class="card_result_column2">
                <div class="flight_price">
                  <p><%= trip[:details][:price]%> <%= trip[:details][:currency]%></p>
                </div>
                <p>Temps de voyage</p>
                <div class="flights_durations_table">
                  <div class="start_flight_duration">
                    <p><i class="fa fa-plane" aria-hidden="true"></i>Aller</p>
                    <p><%= trip[:details][:start_trip_duration]%>  H</p>
                  </div>
                  <div class="return_flight_duration">
                    <p><i class="fa fa-plane" aria-hidden="true"></i>Retour</p>
                    <p><%= trip[:details][:return_trip_duration]%> H</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    <div class="results_details">
      <div class="flight_details_container">
        <h3>Vol aller</h3>
        <div class="flight_card">
          <div class="one_trip_table">
            <div class="trip_table_head">
              <div class="time"><i class="fa fa-calendar" aria-hidden="true"></i></div>
              <div class="place"><i class="fa fa-globe" aria-hidden="true"></i></div>
              <div class="company">Airline</div>
              <div class="duration"><i class="fa fa-clock-o" aria-hidden="true"></i></div>
            </div>
            <div class="flight_row">
              <div class="time"><p><%= @trips_results[0][:depart_flights].first.departure_datetime.to_date.strftime("%A, %b %d") %></p></div>
              <div class="place"><%= @trips_results[0][:depart_flights].first.departure_airport%></div>
              <div class="company"><%= @trips_results[0][:depart_flights].first.marketing_airline%></div>
              <div class="duration">To do API</div>
            </div>
            <div class="stopover_row">
              <div class= "stopover_draw">Stopover</div>
              <div class= "stopover_duration">3H30</div>
            </div>
            <div class="flight_row">
              <div class="time"><p><%= @trips_results[0][:depart_flights][1].departure_datetime.to_date.strftime("%A, %b %d") %></p></div>
              <div class="place"><%= @trips_results[0][:depart_flights][1].departure_airport%></div>
              <div class="company"><%= @trips_results[0][:depart_flights][1].marketing_airline%></div>
              <div class="duration">TO DO API</div>
            </div>
          </div>
        </div>

        <h3>Vol retour</h3>
        <div class="flight_card">
          <div class="one_trip_table">
            <div class="trip_table_head">
              <div class="time"><i class="fa fa-calendar" aria-hidden="true"></i></div>
              <div class="place"><i class="fa fa-globe" aria-hidden="true"></i></div>
              <div class="company">Airline</div>
              <div class="duration"><i class="fa fa-clock-o" aria-hidden="true"></i></div>
            </div>
            <div class="flight_row">
              <div class="time"><p><%= @trips_results[1][:return_flights].first.departure_datetime.to_date.strftime("%A, %b %d") %></p></div>
              <div class="place"><%= @trips_results[1][:return_flights].first.departure_airport%></div>
              <div class="company"><%= @trips_results[1][:return_flights].first.marketing_airline%></div>
              <div class="duration">To do API</div>
            </div>
            <div class="stopover_row">
              <div class= "stopover_draw">Stopover</div>
              <div class= "stopover_duration">3H30</div>
            </div>
            <div class="flight_row">
              <div class="time"><p><%= @trips_results[1][:return_flights][1].departure_datetime.to_date.strftime("%A, %b %d") %></p></div>
              <div class="place"><%= @trips_results[1][:return_flights][1].departure_airport%></div>
              <div class="company"><%= @trips_results[1][:return_flights][1].marketing_airline%></div>
              <div class="duration">TO DO API</div>
            </div>
          </div>
        </div>

      </div>


    </div>


  </div>
</div>
<% content_for(:after_js) do %>
  <script>
    $(document).ready(function(){
      $('.date_representation_sliders').each(function(){
        console.log();
        var slider = noUiSlider.create(this, {
          start: [$(this).data('departure_date'), $(this).data('arrival_date')],
          connect: true,
          step: 1,
          range: {
            'min': 1,
            'max': 31,
          },
          disabled: true,
          format: wNumb({decimals: 0})
        });
        this.setAttribute('disabled', true);
      })
    })
  </script>
<% end %>
